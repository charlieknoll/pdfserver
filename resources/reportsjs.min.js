!function(e){var t=this||(0,eval)("this"),a=t.document;t.navigator,t.JSON;!function(e){"function"==typeof define&&define.amd?define(["exports","require"],e):e("object"==typeof exports&&"object"==typeof module?module.exports||exports:t.rjs={})}(function(e,s){function o(e,t){var a=this;a.element=e,a.headers=[];for(var s=e.getElementsByClassName(t.groupHeaderClass),o=0;o<s.length;o++)a.element===s[o].parentElement&&a.headers.push(s[o].cloneNode(!0));a.firstPage=null}function r(t,a){var s=this;if(s.element=t,s.options=a.options,e.utils.wrapInner(t,"div","class",e.wrapperClass),s.innerContent=s.element.childNodes[0],a.pages.length>0){var o,r,n=s.element.childNodes[0];for(r=0;r<a.headers.length;++r)o=a.headers[r].cloneNode(!0),n.insertBefore(o,null);for(s.firstFooter=null,r=0;r<a.footers.length;r++)0===r?(s.firstFooter=a.footers[r].cloneNode(!0),n.insertBefore(s.firstFooter,null)):n.insertBefore(a.footers[r].cloneNode(!0),null)}else a.footers.length>0&&(s.firstFooter=a.footers[0]);s.insertSpacer(),s.availableHeight=0,s.innerHeight=a.pageInnerHeight,s.nodesAdded=0}function n(e,s,o){var r=this;r.options=new Options(o),r.target=e;var n=r.options.fontDelay;if(r.options.showLoading&&n<500&&(n=500),r.options.readyToFormatPropertyName);if(s.className.includes(r.options.pageClass)||(s.classList.add(r.options.pageClass),console.log("WARNING: The page container class'"+r.options.pageClass+"' was not found on source, responsive elements may not display correctly.")),r.options.showLoading){var i=a.createElement("div");i.innerHTML='<div class="'+r.options.pageClass+" "+r.options.paperType()+'"><div class="rjs-loading"><div></div><div>Generating report...</div></div></div>',i.style.marginBottom="1000px",e.parentElement.insertBefore(i,e)}e.style.overflow="hidden",e.style.maxHeight="0px";for(var l=null,p=r.options.prefix+"ps-",d=0;d<s.classList.length;d++)s.classList[d].substring(0,p.length)==p&&(l=s.classList[d]);r.options.setPaperType(l);var g=r.options.hiddenCss(),h=a.head||a.getElementsByTagName("head")[0],c=a.createElement("style");c.type="text/css",c.styleSheet?c.styleSheet.cssText=g:c.appendChild(a.createTextNode(g)),h.appendChild(c),s.classList.remove(l),s.classList.add(r.options.paperType()),r.blankPageCt=0,t.setTimeout(function(){r.init(e,s),r.generate(!0),r.options.showLoading&&(e.style.display="",i.parentElement.removeChild(i),t.scrollBy(0,-t.pageYOffset)),t[r.options.chromePdfOptionsPropertyName]=r.options.chromeOptions(),t[r.options.renderCompletePropertyName]=!0},n)}NodeList.prototype.last||(NodeList.prototype.last=function(){return this[this.length-1]}),Node.prototype.deleteChildren=function(){for(;this.firstChild;)this.removeChild(this.firstChild)},(e=e||{}).version="##VERSION##",e.wrapperClass="rjs-parent",e.hidden={},e.hiddenBreakPoints=[["a6"],["a5","a6-ls"],["a4","a5-ls"],["letter","legal"],["letter-ls","tabloid","ledger-ls"],["a3","a4-ls"],["legal-ls"],["a2","a3-ls"],["ledger","tabloid-ls"],["a1","a2-ls"],["a0","a1-ls"],["a0-ls"]],Options=function(t){var a=this;a.prefix="rjs-";var s={showLoading:!1,showToolbar:!0,hideSource:!0,base64EncodeImages:!1,format:null,orientation:null,marginLeft:.7,marginTop:.7,marginRight:.7,marginBottom:.7,imageDPI:96,embedFonts:!0,pageClass:a.prefix+"page",pageHeaderClass:a.prefix+"page-header",pageFooterClass:a.prefix+"page-footer",alignBottomClass:a.prefix+"page-footer",groupClass:a.prefix+"group",groupHeaderClass:a.prefix+"group-header",keepTogetherClass:a.prefix+"keep-together",forcePageBreakClass:a.prefix+"force-page-break",hideOnFirstPageClass:a.prefix+"hide-on-first-page",pageCountClass:a.prefix+"page-count",pageNumberClass:a.prefix+"page-number",minimumGroupChildren:1,pdfRenderingUrl:"render.reportsjs.com",renderAuthKey:"",fontDelay:100,parseableNodeNames:["P","BLOCKQUOTE"],keepTogetherNodeNames:["TR","THEAD","TFOOT","CANVAS"],groupNodeNames:["TABLE","DL","DETAILS","OL","UL"],groupHeaderNodeNames:["DT","THEAD","COLGROUP","SUMMARY"],readyToFormatPropertyName:null,readyToFormatTimeOut:1e4,chromePdfOptionsPropertyName:"RESPONSIVE_PAPER_CHROME_PDF_OPTIONS",renderCompletePropertyName:"RESPONSIVE_PAPER_FINISHED"};t&&(t.format&&(t.format=t.format.toLowerCase()),t.landscape&&(t.orientation="landscape"),!1===t.landscape&&(t.orientation="portrait")),e.utils.extend(a,s),e.utils.extend(a,t)},Options.prototype.setPaperType=function(e){var t=this,a=t.prefix+"ps-";null===e&&(e=a+"letter"),e.endsWith("-ls")&&!t.orientation&&(t.orientation="landscape"),t.orientation||(t.orientation="portrait"),e.endsWith("-ls")&&(e=e.substring(0,e.length-3)),e.length>a.length&&!t.format&&e.startsWith(a)&&(t.format=e.split(a)[1])},Options.prototype.paperType=function(){var e=this,t=e.prefix+"ps-"+e.format;return"landscape"==e.orientation&&(t+="-ls"),t},Options.prototype.hiddenCss=function(){var t=this,a="",s=t.format,o=!1;"landscape"==t.orientation&&(s+="-ls");for(var r=0;r<e.hiddenBreakPoints.length;r++)o||e.hiddenBreakPoints[r].forEach(function(e){e===s&&(o=!0)}),o&&e.hiddenBreakPoints[r].forEach(function(e){a+="."+t.prefix+"hidden-"+e+" {display: none} "});return a},Options.prototype.chromeOptions=function(){var e=this,t={};return t.format=e.format.substring(0,1).toUpperCase()+e.format.substring(1),t.margin={},t.margin.top=0,t.margin.left=0,t.margin.right=0,t.margin.bottom=0,t.marginTop=0,t.marginLeft=0,t.marginRight=0,t.marginBottom=0,t.landscape="landscape"===e.orientation,t},e.utils={extend:function(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var a in arguments[t])arguments[t].hasOwnProperty(a)&&(e[a]=arguments[t][a]);return e},wrapInner:function(e,t,s,o){"string"==typeof t&&(t=a.createElement(t));for(e.appendChild(t).setAttribute(s,o);e.firstChild!==t;)t.appendChild(e.firstChild)},outerHeight:function(e,a){var s=e.offsetHeight;if(!a)return s;var o=t.getComputedStyle(e);return s+=parseInt(o.marginTop)+parseInt(o.marginBottom)},height:function(e){var a=t.getComputedStyle(e,null);return parseInt(a.height)-Math.round(parseFloat(a.paddingTop))-Math.round(parseFloat(a.paddingBottom))},clean:function(e,t){for(var a=this,s=0;s<e.childNodes.length;s++){var o=e.childNodes[s];8===o.nodeType&&t||3===o.nodeType&&!/\S/.test(o.nodeValue)?(e.removeChild(o),s--):1===o.nodeType&&a.clean(o,t)}},nodesToArray:function(e){return Array.prototype.slice.call(e,0)},poll:function(e,t,a,s,o){var r=Number(new Date)+(s||2e3);o=o||100,function s(){e()?t():Number(new Date)<r?setTimeout(s,o):a(new Error("timed out for "+e+": "+arguments))}()}},o.prototype.isFirstPage=function(e){return!this.firstPage||this.firstPage.element===e.element},r.prototype.hasParentOfClass=function(e,t){var a=this;return!!e.parentElement.classList.contains(t)||a.element!=e&&a.hasParentOfClass(e.parentElement,t)},r.prototype.insertSpacer=function(){var e=this,t=e.element.childNodes[0],s=a.createElement("div");s.style.height="0px",s.innerHTML="<span style='visibility:hidden;'></span>",s.classList.add("rjs-spacer"),t.insertBefore(s,e.firstFooter),e.firstFooter=s},r.prototype.setAvailableHeight=function(){var t=this,a=t.element.childNodes[0];t.availableHeight=t.innerHeight-e.utils.outerHeight(a,!0)},r.prototype.checkAvailableHeight=function(){var e=this;return e.setAvailableHeight(),e.availableHeight>0},r.prototype.showElements=function(e,t,a){for(var s=this,o=e.childNodes.length-1;o>-1;o--){var r=e.childNodes[o];r.classList&&r.classList.contains(t)&&(r.style.display="initial"),r.classList&&!r.classList.contains(a)&&s.showElements(r,t,a)}},r.prototype.insertElement=function(e,t,a,s){var o=this,r=e.insertBefore(t,a);return s||o.showElements(r,o.options.hideOnFirstPageClass,o.options.groupClass),o.setAvailableHeight(),o.nodesAdded++,r},r.prototype.removeElement=function(e){var t=this;e.parentNode.removeChild(e),t.setAvailableHeight()},n.prototype.init=function(t,a){var s=this,o=e.utils.nodesToArray(a.getElementsByTagName("CANVAS"));s.canvasObjs=[],o.forEach(function(e){var t={};t.id=e.id,t.el=e.cloneNode(!0),t.el.getContext("2d").drawImage(e,0,0),s.canvasObjs.push(t)});var n=a.cloneNode(!0);s.options.hideSource&&(a.style.display="none",a.style.overflow="hidden",a.style.height="0px"),n.style.display="",s.initId=n.id,s.target.insertBefore(n,null),s.removeAttributes("contenteditable"),s.convertClass(s.options.prefix+"hidden-print",s.options.prefix+"hidden"),s.options.groupNodeNames.map(function(e){return s.addClassToElements(e,s.options.groupClass)}),s.options.groupHeaderNodeNames.map(function(e){return s.addClassToElements(e,s.options.groupHeaderClass)}),s.headers=n.getElementsByClassName(s.options.pageHeaderClass),s.footers=n.getElementsByClassName(s.options.pageFooterClass),s.setPageInnerHeight(n),s.pages=[],s.lastPage=new r(n,s),s.pages=[s.lastPage],s.groups=[]},n.prototype.removeAttributes=function(e){var t=this;Array.prototype.slice.call(t.target.lastChild.querySelectorAll("["+e+"]"),0).map(function(t){t.removeAttribute(e)})},n.prototype.convertClass=function(e,t){var a=this;Array.prototype.slice.call(a.target.lastChild.getElementsByClassName(e),0).map(function(a){a.classList.remove(e),a.classList.add(t)})},n.prototype.addDefaultClass=function(e,t){e.classList.add(t)},n.prototype.addClassToElements=function(e,t){var a=this;Array.prototype.slice.call(a.target.lastChild.getElementsByTagName(e),0).map(function(e){a.addDefaultClass(e,t)})},n.prototype.updateCanvasEls=function(){var e=this;e.canvasObjs.forEach(function(t){var a=e.target.querySelector("#"+t.id);a&&a.getContext("2d").drawImage(t.el,0,0)})},n.prototype.generate=function(t){if(t&&(e.startTime=(new Date).getTime()),self=this,self.splitPages(),self.updateCanvasEls(),self.setPageProperties(),self.alignBottomElements(),t){var a=(new Date).getTime();console.log("Formatting finished in "+(a-e.startTime)/1e3+" seconds")}},n.prototype.alignBottomElements=function(){for(var e=this,t=0;t<e.pages.length;t++){var a=e.pages[t];a.setAvailableHeight();var s=a.element.getElementsByClassName("rjs-spacer");a.availableHeight>0&&s.length>0&&(s[0].style.height=a.availableHeight+"px")}},n.prototype.upsertGroup=function(e,t){for(var a=this,s=null,r=0;r<a.groups.length;r++)if(a.groups[r].element===e){(s=a.groups[r]).firstPage||(s.firstPage=t);break}return s||((s=new o(e,a.options)).firstPage=t,a.groups.push(s)),s},n.prototype.setPageProperties=function(){for(var e=this,t=1;t<=e.pages.length;t++){for(var a=e.pages[t-1],s=a.element.getElementsByClassName(e.options.pageNumberClass),o=0;o<s.length;o++)s[o].innerHTML=t;for(s=a.element.getElementsByClassName(e.options.pageCountClass),o=0;o<s.length;o++)s[o].innerHTML=e.pages.length;a.element.id=e.initId+"Page"+t,a.element.style.display=""}},n.prototype.insertPage=function(){var e=this,t=new r(e.lastPage.element.cloneNode(!1),e);e.pages.splice(e.pages.length-1,0,t),e.lastPage.element.parentNode.insertBefore(t.element,e.lastPage.element);var a,s;if(e.pages.length>2)for(a=t.element.getElementsByClassName(e.options.hideOnFirstPageClass),s=0;s<a.length;s++)a[s].classList.remove(e.options.hideOnFirstPageClass);if(2==e.pages.length)for(a=e.lastPage.element.getElementsByClassName(e.options.hideOnFirstPageClass),s=0;s<a.length;s++)(e.lastPage.hasParentOfClass(a[s],e.options.pageHeaderClass)||e.isPageHeader(a[s]))&&a[s].classList.remove(e.options.hideOnFirstPageClass);return t.setAvailableHeight(),t},n.prototype.isKeepTogetherNode=function(e){var t=this;return t.options.keepTogetherNodeNames.indexOf(e.nodeName)>-1||!!e.classList&&(e.classList.contains(t.options.keepTogetherClass)||e.classList.contains(t.options.groupHeaderClass))},n.prototype.isParseableNode=function(e){var t=this;return 3===e.nodeType||t.options.parseableNodeNames.indexOf(e.nodeName)>-1},n.prototype.isPageBand=function(e){if(!e.classList)return!1;var t=this;return e.classList.contains(t.options.pageHeaderClass)||e.classList.contains(t.options.pageFooterClass)},n.prototype.isGroupBand=function(e){if(!e.classList)return!1;var t=this;return e.classList.contains(t.options.groupClass)},n.prototype.isGroupHeader=function(e){if(!e.classList)return!1;var t=this;return e.classList.contains(t.options.groupHeaderClass)},n.prototype.isForcePageBreak=function(e){if(!e.classList)return!1;var t=this;return e.classList.contains(t.options.forcePageBreakClass)},n.prototype.isPageHeader=function(e){if(!e.classList)return!1;var t=this;return e.classList.contains(t.options.pageHeaderClass)},n.prototype.convertImageTobase64=function(e){if("IMG"===e.nodeName){var t=a.createElement("CANVAS"),s=t.getContext("2d"),o=new Image;o.crossOrigin="Anonymous",o.onload=function(a){t.height=o.height,t.width=o.width,s.drawImage(o,0,0);var r=t.toDataURL("image/png",1);$(e).attr("src",r),t=null},o.src=e.src}},n.prototype.splitArray=function(e,t,a,s,o){var r=this,n=a.offsetHeight,i=t.availableHeight,l=e.splice(0,e.length-s);if(a.lastChild.data=l.join(" "),n!=a.offsetHeight&&t.setAvailableHeight(),t.availableHeight>=0&&0===e.length)return e;if(o<=1&&t.availableHeight>=0&&i<0)return e;var p=0;return p=t.availableHeight>0?s-Math.round(o/2):s+Math.round(o/2),r.splitArray(l.concat(e),t,a,p,Math.abs(p-s))},n.prototype.moveTextBetweenNodesFast=function(e,t,a){var s=this;if(a.availableHeight<1)return!1;var o=t.textContent.trim().replace(/[\n\r]+/g,"").replace(/\s{2,10}/g," ").split(" "),r=Math.round(o.length/2);return 0!==e.childNodes.length&&3===e.lastChild.nodeType||(e.innerHTML=e.innerHTML+" "),sourceArray=s.splitArray(o,a,e,r,r),0===sourceArray.length&&a.checkAvailableHeight()?(t.parentElement.removeChild(t),!1):(t.data=sourceArray.join(" "),!0)},n.prototype.moveTextBetweenNodes=function(e,t,a){var s=t.textContent.trim().replace(/[\n\r]+/g,"").replace(/\s{2,10}/g," ").split(" ");s.reverse();var o=e.offsetHeight,r="";for(0!==e.childNodes.length&&3===e.lastChild.nodeType||(e.innerHTML=e.innerHTML+" ");s.length>0&&(o===e.offsetHeight||a.checkAvailableHeight());)o=e.offsetHeight,r=s.pop(),e.lastChild.data=e.lastChild.data+" "+r;return 0===s.length&&a.checkAvailableHeight()?(t.parentElement.removeChild(t),!1):(s.push(r),s.reverse(),t.data=s.join(" "),e.lastChild.data=e.lastChild.data.substring(0,e.lastChild.data.length-r.length-1),!0)},n.prototype.moveParseableChildNodes=function(e,t,a){var s=this,o=a.childNodes;if(0===o.length)return!1;for(var r=0;r<o.length;r++){var n=o[r];if(3===n.nodeType){if(s.moveTextBetweenNodesFast(t,n,e))return!0}else{if(t.insertBefore(n.cloneNode(!1),null),!e.checkAvailableHeight())return t.removeChild(t.lastChild),!0;if(s.moveParseableChildNodes(e,t.lastChild,n))return!0;a.removeChild(n)}--r}return!1},n.prototype.shouldPageBreak=function(e){var t=this;return!!t.isForcePageBreak(e)&&(t.pageBreakElement!==e&&(t.pageBreakElement=e,!0))},n.prototype.resetGroupBandSource=function(t,a,s,o){var r=this,n=e.utils.height(a),i=a.getElementsByClassName(r.options.groupHeaderClass);for(j=0;j<i.length;j++)i[j].parentNode===a&&(n-=e.utils.outerHeight(i[j],!0));if(0===n){for(var l=s.getElementsByClassName(r.options.groupHeaderClass);l.length>0;)l[0].remove();t.removeElement(a),o.firstPage=null}for(var p=s.childNodes[0],d=0;d<o.headers.length;d++)t.insertElement(s,o.headers[d].cloneNode(!0),p,o.isFirstPage(t))},n.prototype.insertGroupBand=function(e,t,a,s){var o=this,r=o.upsertGroup(a,e),n=e.insertElement(t,a.cloneNode(!1),s,r.isFirstPage(e));return!!o.moveChildElements(a,e,n,null,r)&&(o.resetGroupBandSource(e,n,a,r),!0)},n.prototype.moveChildElements=function(e,t,a,s,o){var r=this,n=e.childNodes;if(0===n.length&&t.availableHeight>0)return!1;for(var i,l=!o||o.firstPage===t,p=0;p<n.length;p++){var d=n[p];if((!d.style||"hidden"!==d.style.visibility)&&!r.isPageBand(d)){if(!0===r.shouldPageBreak(d))return!0;var g=r.isKeepTogetherNode(d);if(r.isGroupBand(d)&&!g){if(r.insertGroupBand(t,a,d,s))return!0}else{var h=r.isParseableNode(d),c=t.availableHeight>(d.offsetHeight||0);if(!c&&g)return!0;var f=d.cloneNode(c),u=0,m=!1;if(!c&&d.childNodes.length>1&&!h&&0===d.getElementsByClassName(r.options.forcePageBreakClass).length)for(var v=d.offsetHeight;d.childNodes.length>0&&u<t.availableHeight&&!r.isForcePageBreak(d);)f.insertBefore(d.removeChild(d.childNodes[0]),null),(u=v-d.offsetHeight)>t.availableHeight&&(d.insertBefore(f.removeChild(f.lastChild),d.childNodes[0]),m=!0);if(i=t.insertElement(a,f,s,l),f.classList.contains("rjs-contain")&&t.availableHeight<0&&(f.style.maxHeight=t.availableHeight+(d.offsetHeight?d.offsetHeight:d.scrollHeight)-1+"px",t.setAvailableHeight()),t.availableHeight<0||m||!c){if(g||!h&&0===d.children.length)return t.removeElement(i),t.setAvailableHeight(),!0;if(i.childNodes.length>0)if(0===u)i.deleteChildren(),t.setAvailableHeight();else for(;!t.checkAvailableHeight();)d.insertBefore(i.removeChild(i.lastChild),d.childNodes[0]);return h?r.moveParseableChildNodes(t,i,d):r.moveChildElements(d,t,i,null,o),!0}}d.parentNode.removeChild(d),r.options.convertImageTobase64&&r.convertImageTobase64(i),--p}}return!1},n.prototype.setPageInnerHeight=function(t){this.pageInnerHeight=e.utils.height(t)},n.prototype.splitPages=function(){var e=this;e.lastPage.setAvailableHeight();var t=e.lastPage.availableHeight,s=e.insertPage();if(e.moveChildElements(e.lastPage.innerContent,s,s.innerContent,s.firstFooter)){if(e.lastPage.setAvailableHeight(),t===e.lastPage.availableHeight){if(0!==e.blankPageCt){console.log("Infinite loop avoided, check report design for 'keep-together' or 'group-header' nodes that are too large to fit on one page");var o=a.createElement("p");return o.innerHTML="<div style='color:red'><p>ERROR: <br/>Layout engine could not add content to the page container. Possible solutions:</p><ul><li>Increase page height by removing landscape or selecting a larger paper format.</li><li>Shrink items so they can fit on a page, e.g. use max-height on images or canvas elements</li><li>Check report design for 'keep-together' or 'group-header' nodes that are too large to fit on one page</li></ul>",void e.pages[0].element.insertBefore(o,e.pages[0].element.firstChild)}e.blankPageCt++,console.log("Could not add any content to page, try removing force-page-break from first group or shrinking items so they can fit on a page")}e.splitPages()}else e.lastPage.element.remove(),e.lastPage=s,e.pages.pop(e.pages.length-1),1===e.blankPageCt&&(e.lastPage.element.remove(),e.pages.pop(e.pages.length-1),e.lastPage=e.pages[e.pages.length-1])},e.createTarget=function(e,t){var s=a.createElement("div");return s.innerHTML="<div id='previewPane' class='rjs-target'><span style='visibility:hidden;'>\x3c!--first element --\x3e</span></div>",e.insertBefore(s,t),s.childNodes[0]},e.preview=function(s,o,r){if(s||(s=[t.document.body]),s[0]===t.document.body){var i=a.createElement("div");Array.prototype.slice.call(t.document.body.childNodes,0).map(function(e){i.appendChild(e)}),t.document.body.insertBefore(i,null),s[0]=t.document.body.firstChild}r||(r=e.createTarget(s[0].parentNode,s[0]));for(var l=0;l<s.length;l++){e.utils.clean(s[l],!0);new n(r,s[l],o)}r.style.overflow="",r.style.maxHeight=""},e.renderAsPDF=function(e,t,a){},e.refresh=function(e,t){},e.renderAsExcel=function(e,t){}})}();