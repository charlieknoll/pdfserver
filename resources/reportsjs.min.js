!function(e){var t=this||(0,eval)("this"),a=t.document;t.navigator,t.JSON;!function(e){"function"==typeof define&&define.amd?define(["exports","require"],e):e("object"==typeof exports&&"object"==typeof module?module.exports||exports:t.rjs={})}(function(e,s){function r(e,t){var a=this;a.element=e,a.headers=[];for(var s=e.getElementsByClassName(t.groupHeaderClass),r=0;r<s.length;r++)a.element===s[r].parentElement&&a.headers.push(s[r].cloneNode(!0));a.firstPage=null}function o(t,a){var s=this;if(s.element=t,s.options=a.options,e.utils.wrapInner(t,"div","class",e.wrapperClass),s.innerContent=s.element.childNodes[0],a.pages.length>0){var r,o,n=s.element.childNodes[0];for(o=0;o<a.headers.length;++o)r=a.headers[o].cloneNode(!0),n.insertBefore(r,null);for(s.firstFooter=null,o=0;o<a.footers.length;o++)0===o?(s.firstFooter=a.footers[o].cloneNode(!0),n.insertBefore(s.firstFooter,null)):n.insertBefore(a.footers[o].cloneNode(!0),null)}else a.footers.length>0&&(s.firstFooter=a.footers[0]);s.insertSpacer(),s.availableHeight=0,s.innerHeight=a.pageInnerHeight,s.nodesAdded=0}function n(e,s,r){var o=this;o.options=new Options(r),o.target=e;var n=o.options.fontDelay;if(o.options.showLoading&&n<500&&(n=500),o.options.readyToFormatPropertyName);if(s.className.includes(o.options.pageClass)||(s.classList.add(o.options.pageClass),console.log("WARNING: The page container class'"+o.options.pageClass+"' was not found on source, responsive elements may not display correctly.")),o.options.showLoading){var i=a.createElement("div");i.innerHTML='<div class="'+o.options.pageClass+" "+o.options.paperType()+'"><div class="rjs-loading"><div></div><div>Generating report...</div></div></div>',i.style.marginBottom="1000px",e.parentElement.insertBefore(i,e)}for(var l=null,p=o.options.prefix+"ps-",g=0;g<s.classList.length;g++)s.classList[g].substring(0,p.length)==p&&(l=s.classList[g]);o.options.setPaperType(l);var d=o.options.hiddenCss(),h=a.head||a.getElementsByTagName("head")[0],f=a.createElement("style");f.type="text/css",f.styleSheet?f.styleSheet.cssText=d:f.appendChild(a.createTextNode(d)),h.appendChild(f),s.classList.remove(l),s.classList.add(o.options.paperType()),o.blankPageCt=0,t.setTimeout(function(){o.init(e,s),o.generate(!0),o.options.showLoading&&(e.style.display="",i.parentElement.removeChild(i),t.scrollBy(0,-t.pageYOffset)),t[o.options.chromePdfOptionsPropertyName]=o.options.chromeOptions(),t[o.options.renderCompletePropertyName]=!0},n)}NodeList.prototype.last||(NodeList.prototype.last=function(){return this[this.length-1]}),Node.prototype.deleteChildren=function(){for(;this.firstChild;)this.removeChild(this.firstChild)},(e=e||{}).version="##VERSION##",e.wrapperClass="rjs-parent",e.hidden={},e.hiddenBreakPoints=[["a6"],["a5","a6-ls"],["a4","a5-ls"],["letter","legal"],["letter-ls","tabloid","ledger-ls"],["a3","a4-ls"],["legal-ls"],["a2","a3-ls"],["ledger","tabloid-ls"],["a1","a2-ls"],["a0","a1-ls"],["a0-ls"]],Options=function(t){var a=this;a.prefix="rjs-";var s={showLoading:!1,showToolbar:!0,hideSource:!0,base64EncodeImages:!1,format:null,orientation:null,marginLeft:.7,marginTop:.7,marginRight:.7,marginBottom:.7,imageDPI:96,embedFonts:!0,pageClass:a.prefix+"page",pageHeaderClass:a.prefix+"page-header",pageFooterClass:a.prefix+"page-footer",alignBottomClass:a.prefix+"page-footer",groupClass:a.prefix+"group",groupHeaderClass:a.prefix+"group-header",keepTogetherClass:a.prefix+"keep-together",forcePageBreakClass:a.prefix+"force-page-break",hideOnFirstPageClass:a.prefix+"hide-on-first-page",pageCountClass:a.prefix+"page-count",pageNumberClass:a.prefix+"page-number",minimumGroupChildren:1,pdfRenderingUrl:"render.reportsjs.com",renderAuthKey:"",fontDelay:100,parseableNodeNames:["P","BLOCKQUOTE"],keepTogetherNodeNames:["TR","THEAD","TFOOT","CANVAS"],groupNodeNames:["TABLE","DL","DETAILS","OL","UL"],groupHeaderNodeNames:["DT","THEAD","COLGROUP","SUMMARY"],readyToFormatPropertyName:null,readyToFormatTimeOut:1e4,chromePdfOptionsPropertyName:"RESPONSIVE_PAPER_CHROME_PDF_OPTIONS",renderCompletePropertyName:"RESPONSIVE_PAPER_FINISHED"};t&&(t.format&&(t.format=t.format.toLowerCase()),t.landscape&&(t.orientation="landscape"),!1===t.landscape&&(t.orientation="portrait")),e.utils.extend(a,s),e.utils.extend(a,t)},Options.prototype.setPaperType=function(e){var t=this,a=t.prefix+"ps-";null===e&&(e=a+"letter"),e.endsWith("-ls")&&!t.orientation&&(t.orientation="landscape"),t.orientation||(t.orientation="portrait"),e.endsWith("-ls")&&(e=e.substring(0,e.length-3)),e.length>a.length&&!t.format&&e.startsWith(a)&&(t.format=e.split(a)[1])},Options.prototype.paperType=function(){var e=this,t=e.prefix+"ps-"+e.format;return"landscape"==e.orientation&&(t+="-ls"),t},Options.prototype.hiddenCss=function(){var t=this,a="",s=t.format,r=!1;"landscape"==t.orientation&&(s+="-ls");for(var o=0;o<e.hiddenBreakPoints.length;o++)r||e.hiddenBreakPoints[o].forEach(function(e){e===s&&(r=!0)}),r&&e.hiddenBreakPoints[o].forEach(function(e){a+="."+t.prefix+"hidden-"+e+" {display: none} "});return a},Options.prototype.chromeOptions=function(){var e=this,t={};return t.format=e.format.substring(0,1).toUpperCase()+e.format.substring(1),t.margin={},t.margin.top=0,t.margin.left=0,t.margin.right=0,t.margin.bottom=0,t.marginTop=0,t.marginLeft=0,t.marginRight=0,t.marginBottom=0,t.landscape="landscape"===e.orientation,t},e.utils={extend:function(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var a in arguments[t])arguments[t].hasOwnProperty(a)&&(e[a]=arguments[t][a]);return e},wrapInner:function(e,t,s,r){"string"==typeof t&&(t=a.createElement(t));for(e.appendChild(t).setAttribute(s,r);e.firstChild!==t;)t.appendChild(e.firstChild)},outerHeight:function(e,a){var s=e.offsetHeight;if(!a)return s;var r=t.getComputedStyle(e);return s+=parseInt(r.marginTop)+parseInt(r.marginBottom)},height:function(e){var a=t.getComputedStyle(e,null);return parseInt(a.height)-Math.round(parseFloat(a.paddingTop))-Math.round(parseFloat(a.paddingBottom))},clean:function(e,t){for(var a=this,s=0;s<e.childNodes.length;s++){var r=e.childNodes[s];8===r.nodeType&&t||3===r.nodeType&&!/\S/.test(r.nodeValue)?(e.removeChild(r),s--):1===r.nodeType&&a.clean(r,t)}},nodesToArray:function(e){return Array.prototype.slice.call(e,0)},poll:function(e,t,a,s,r){var o=Number(new Date)+(s||2e3);r=r||100,function s(){e()?t():Number(new Date)<o?setTimeout(s,r):a(new Error("timed out for "+e+": "+arguments))}()}},r.prototype.isFirstPage=function(e){return!this.firstPage||this.firstPage.element===e.element},o.prototype.hasParentOfClass=function(e,t){var a=this;return!!e.parentElement.classList.contains(t)||a.element!=e&&a.hasParentOfClass(e.parentElement,t)},o.prototype.insertSpacer=function(){var e=this,t=e.element.childNodes[0],s=a.createElement("div");s.style.height="0px",s.innerHTML="<span style='visibility:hidden;'></span>",s.classList.add("rjs-spacer"),t.insertBefore(s,e.firstFooter),e.firstFooter=s},o.prototype.setAvailableHeight=function(){var t=this,a=t.element.childNodes[0];t.availableHeight=t.innerHeight-e.utils.outerHeight(a,!0)},o.prototype.checkAvailableHeight=function(){var e=this;return e.setAvailableHeight(),e.availableHeight>0},o.prototype.showElements=function(e,t,a){for(var s=this,r=e.childNodes.length-1;r>-1;r--){var o=e.childNodes[r];o.classList&&o.classList.contains(t)&&(o.style.display="initial"),o.classList&&!o.classList.contains(a)&&s.showElements(o,t,a)}},o.prototype.insertElement=function(e,t,a,s){var r=this,o=e.insertBefore(t,a);return s||r.showElements(o,r.options.hideOnFirstPageClass,r.options.groupClass),r.setAvailableHeight(),r.nodesAdded++,o},o.prototype.removeElement=function(e){var t=this;e.parentNode.removeChild(e),t.setAvailableHeight()},n.prototype.init=function(t,a){var s=this,r=e.utils.nodesToArray(a.getElementsByTagName("CANVAS"));s.canvasObjs=[],r.forEach(function(e){var t={};t.id=e.id,t.el=e.cloneNode(!0),t.el.getContext("2d").drawImage(e,0,0),s.canvasObjs.push(t)});var n=a.cloneNode(!0);s.options.hideSource&&(a.style.display="none",a.style.overflow="hidden",a.style.height="0px"),n.style.display="",s.initId=n.id;var i=s.target.insertBefore(n,a);s.removeAttributes(i,"contenteditable"),s.options.groupNodeNames.map(function(e){return s.addClassToElements(i,e,s.options.groupClass)}),s.options.groupHeaderNodeNames.map(function(e){return s.addClassToElements(i,e,s.options.groupHeaderClass)}),s.headers=n.getElementsByClassName(s.options.pageHeaderClass),s.footers=n.getElementsByClassName(s.options.pageFooterClass),s.setPageInnerHeight(n),s.pages=[],s.lastPage=new o(n,s),s.pages=[s.lastPage],s.groups=[]},n.prototype.removeAttributes=function(e,t){Array.prototype.slice.call(e.querySelectorAll("["+t+"]"),0).map(function(e){e.removeAttribute(t)})},n.prototype.addDefaultClass=function(e,t){e.classList.add(t)},n.prototype.addClassToElements=function(e,t,a){var s=this;Array.prototype.slice.call(e.getElementsByTagName(t),0).map(function(e){s.addDefaultClass(e,a)})},n.prototype.updateCanvasEls=function(){var e=this;e.canvasObjs.forEach(function(t){var a=e.target.querySelector("#"+t.id);a&&a.getContext("2d").drawImage(t.el,0,0)})},n.prototype.generate=function(t){if(t&&(e.startTime=(new Date).getTime()),self=this,self.splitPages(),self.updateCanvasEls(),self.setPageProperties(),self.alignBottomElements(),t){var a=(new Date).getTime();console.log("Formatting finished in "+(a-e.startTime)/1e3+" seconds")}},n.prototype.alignBottomElements=function(){for(var e=this,t=0;t<e.pages.length;t++){var a=e.pages[t];a.setAvailableHeight();var s=a.element.getElementsByClassName("rjs-spacer");a.availableHeight>0&&s.length>0&&(s[0].style.height=a.availableHeight+"px")}},n.prototype.upsertGroup=function(e,t){for(var a=this,s=null,o=0;o<a.groups.length;o++)if(a.groups[o].element===e){(s=a.groups[o]).firstPage||(s.firstPage=t);break}return s||((s=new r(e,a.options)).firstPage=t,a.groups.push(s)),s},n.prototype.setPageProperties=function(){for(var e=this,t=1;t<=e.pages.length;t++){for(var a=e.pages[t-1],s=a.element.getElementsByClassName(e.options.pageNumberClass),r=0;r<s.length;r++)s[r].innerHTML=t;for(s=a.element.getElementsByClassName(e.options.pageCountClass),r=0;r<s.length;r++)s[r].innerHTML=e.pages.length;a.element.id=e.initId+"Page"+t,a.element.style.display=""}},n.prototype.insertPage=function(){var e=this,t=new o(e.lastPage.element.cloneNode(!1),e);e.pages.splice(e.pages.length-1,0,t),e.lastPage.element.parentNode.insertBefore(t.element,e.lastPage.element);var a,s;if(e.pages.length>2)for(a=t.element.getElementsByClassName(e.options.hideOnFirstPageClass),s=0;s<a.length;s++)a[s].classList.remove(e.options.hideOnFirstPageClass);if(2==e.pages.length)for(a=e.lastPage.element.getElementsByClassName(e.options.hideOnFirstPageClass),s=0;s<a.length;s++)(e.lastPage.hasParentOfClass(a[s],e.options.pageHeaderClass)||e.isPageHeader(a[s]))&&a[s].classList.remove(e.options.hideOnFirstPageClass);return t.setAvailableHeight(),t},n.prototype.isKeepTogetherNode=function(e){var t=this;return t.options.keepTogetherNodeNames.indexOf(e.nodeName)>-1||!!e.classList&&(e.classList.contains(t.options.keepTogetherClass)||e.classList.contains(t.options.groupHeaderClass))},n.prototype.isParseableNode=function(e){var t=this;return 3===e.nodeType||t.options.parseableNodeNames.indexOf(e.nodeName)>-1},n.prototype.isPageBand=function(e){if(!e.classList)return!1;var t=this;return e.classList.contains(t.options.pageHeaderClass)||e.classList.contains(t.options.pageFooterClass)},n.prototype.isGroupBand=function(e){if(!e.classList)return!1;var t=this;return e.classList.contains(t.options.groupClass)},n.prototype.isGroupHeader=function(e){if(!e.classList)return!1;var t=this;return e.classList.contains(t.options.groupHeaderClass)},n.prototype.isForcePageBreak=function(e){if(!e.classList)return!1;var t=this;return e.classList.contains(t.options.forcePageBreakClass)},n.prototype.isPageHeader=function(e){if(!e.classList)return!1;var t=this;return e.classList.contains(t.options.pageHeaderClass)},n.prototype.convertImageTobase64=function(e){if("IMG"===e.nodeName){var t=a.createElement("CANVAS"),s=t.getContext("2d"),r=new Image;r.crossOrigin="Anonymous",r.onload=function(a){t.height=r.height,t.width=r.width,s.drawImage(r,0,0);var o=t.toDataURL("image/png",1);$(e).attr("src",o),t=null},r.src=e.src}},n.prototype.splitArray=function(e,t,a,s,r){var o=this,n=a.offsetHeight,i=t.availableHeight,l=e.splice(0,e.length-s);if(a.lastChild.data=l.join(" "),n!=a.offsetHeight&&t.setAvailableHeight(),t.availableHeight>=0&&0===e.length)return e;if(r<=1&&t.availableHeight>=0&&i<0)return e;var p=0;return p=t.availableHeight>0?s-Math.round(r/2):s+Math.round(r/2),o.splitArray(l.concat(e),t,a,p,Math.abs(p-s))},n.prototype.moveTextBetweenNodesFast=function(e,t,a){var s=this;if(a.availableHeight<1)return!1;var r=t.textContent.trim().replace(/[\n\r]+/g,"").replace(/\s{2,10}/g," ").split(" "),o=Math.round(r.length/2);return 0!==e.childNodes.length&&3===e.lastChild.nodeType||(e.innerHTML=e.innerHTML+" "),sourceArray=s.splitArray(r,a,e,o,o),0===sourceArray.length&&a.checkAvailableHeight()?(t.parentElement.removeChild(t),!1):(t.data=sourceArray.join(" "),!0)},n.prototype.moveTextBetweenNodes=function(e,t,a){var s=t.textContent.trim().replace(/[\n\r]+/g,"").replace(/\s{2,10}/g," ").split(" ");s.reverse();var r=e.offsetHeight,o="";for(0!==e.childNodes.length&&3===e.lastChild.nodeType||(e.innerHTML=e.innerHTML+" ");s.length>0&&(r===e.offsetHeight||a.checkAvailableHeight());)r=e.offsetHeight,o=s.pop(),e.lastChild.data=e.lastChild.data+" "+o;return 0===s.length&&a.checkAvailableHeight()?(t.parentElement.removeChild(t),!1):(s.push(o),s.reverse(),t.data=s.join(" "),e.lastChild.data=e.lastChild.data.substring(0,e.lastChild.data.length-o.length-1),!0)},n.prototype.moveParseableChildNodes=function(e,t,a){var s=this,r=a.childNodes;if(0===r.length)return!1;for(var o=0;o<r.length;o++){var n=r[o];if(3===n.nodeType){if(s.moveTextBetweenNodesFast(t,n,e))return!0}else{if(t.insertBefore(n.cloneNode(!1),null),!e.checkAvailableHeight())return t.removeChild(t.lastChild),!0;if(s.moveParseableChildNodes(e,t.lastChild,n))return!0;a.removeChild(n)}--o}return!1},n.prototype.shouldPageBreak=function(e){var t=this;return!!t.isForcePageBreak(e)&&(t.pageBreakElement!==e&&(t.pageBreakElement=e,!0))},n.prototype.resetGroupBandSource=function(t,a,s,r){var o=this,n=e.utils.height(a),i=a.getElementsByClassName(o.options.groupHeaderClass);for(j=0;j<i.length;j++)i[j].parentNode===a&&(n-=e.utils.outerHeight(i[j],!0));if(0===n){for(var l=s.getElementsByClassName(o.options.groupHeaderClass);l.length>0;)l[0].remove();t.removeElement(a),r.firstPage=null}for(var p=s.childNodes[0],g=0;g<r.headers.length;g++)t.insertElement(s,r.headers[g].cloneNode(!0),p,r.isFirstPage(t))},n.prototype.insertGroupBand=function(e,t,a,s){var r=this,o=r.upsertGroup(a,e),n=e.insertElement(t,a.cloneNode(!1),s,o.isFirstPage(e));return!!r.moveChildElements(a,e,n,null,o)&&(r.resetGroupBandSource(e,n,a,o),!0)},n.prototype.moveChildElements=function(e,t,a,s,r){var o=this,n=e.childNodes;if(0===n.length&&t.availableHeight>0)return!1;for(var i,l=!r||r.firstPage===t,p=0;p<n.length;p++){var g=n[p];if((!g.style||"hidden"!==g.style.visibility)&&!o.isPageBand(g)){if(!0===o.shouldPageBreak(g))return!0;var d=o.isKeepTogetherNode(g);if(o.isGroupBand(g)&&!d){if(o.insertGroupBand(t,a,g,s))return!0}else{var h=o.isParseableNode(g),f=t.availableHeight>(g.offsetHeight||0);if(!f&&d)return!0;var c=g.cloneNode(f),u=0,m=!1;if(!f&&g.childNodes.length>1&&!h&&0===g.getElementsByClassName(o.options.forcePageBreakClass).length)for(var v=g.offsetHeight;g.childNodes.length>0&&u<t.availableHeight&&!o.isForcePageBreak(g);)c.insertBefore(g.removeChild(g.childNodes[0]),null),(u=v-g.offsetHeight)>t.availableHeight&&(g.insertBefore(c.removeChild(c.lastChild),g.childNodes[0]),m=!0);if(i=t.insertElement(a,c,s,l),c.classList.contains("rjs-contain")&&t.availableHeight<0&&(c.style.maxHeight=t.availableHeight+(g.offsetHeight?g.offsetHeight:g.scrollHeight)-1+"px",t.setAvailableHeight()),t.availableHeight<0||m||!f){if(d||!h&&0===g.children.length)return t.removeElement(i),t.setAvailableHeight(),!0;if(i.childNodes.length>0)if(0===u)i.deleteChildren(),t.setAvailableHeight();else for(;!t.checkAvailableHeight();)g.insertBefore(i.removeChild(i.lastChild),g.childNodes[0]);return h?o.moveParseableChildNodes(t,i,g):o.moveChildElements(g,t,i,null,r),!0}}g.parentNode.removeChild(g),o.options.convertImageTobase64&&o.convertImageTobase64(i),--p}}return!1},n.prototype.setPageInnerHeight=function(t){this.pageInnerHeight=e.utils.height(t)},n.prototype.splitPages=function(){var e=this;e.lastPage.setAvailableHeight();var t=e.lastPage.availableHeight,s=e.insertPage();if(e.moveChildElements(e.lastPage.innerContent,s,s.innerContent,s.firstFooter)){if(e.lastPage.setAvailableHeight(),t===e.lastPage.availableHeight){if(0!==e.blankPageCt){console.log("Infinite loop avoided, check report design for 'keep-together' or 'group-header' nodes that are too large to fit on one page");var r=a.createElement("p");return r.innerHTML="<div style='color:red'><p>ERROR: <br/>Layout engine could not add content to the page container. Possible solutions:</p><ul><li>Increase page height by removing landscape or selecting a larger paper format.</li><li>Shrink items so they can fit on a page, e.g. use max-height on images or canvas elements</li><li>Check report design for 'keep-together' or 'group-header' nodes that are too large to fit on one page</li></ul>",void e.pages[0].element.insertBefore(r,e.pages[0].element.firstChild)}e.blankPageCt++,console.log("Could not add any content to page, try removing force-page-break from first group or shrinking items so they can fit on a page")}e.splitPages()}else e.lastPage.element.remove(),e.lastPage=s,e.pages.pop(e.pages.length-1),1===e.blankPageCt&&(e.lastPage.element.remove(),e.pages.pop(e.pages.length-1),e.lastPage=e.pages[e.pages.length-1])},e.createTarget=function(e,t){var s=a.createElement("div");return s.innerHTML="<div id='previewPane' class='rjs-target'><span style='visibility:hidden;'>\x3c!--first element --\x3e</span></div>",e.insertBefore(s,t),s.childNodes[0]},e.preview=function(s,r){if(s||(s=[a.querySelector(".rjs-page")]),!s){s=[t.document.body];var o=a.createElement("div");Array.prototype.slice.call(t.document.body.childNodes,0).map(function(e){o.appendChild(e)}),o.classList.add("rjs-page"),t.document.body.insertBefore(o,null),s[0]=t.document.body.firstChild}target=s[0].parentNode;for(var i=0;i<s.length;i++){e.utils.clean(s[i],!0);new n(target,s[i],r)}target.style.overflow="",target.style.maxHeight=""},e.renderAsPDF=function(e,t,a){},e.refresh=function(e,t){},e.renderAsExcel=function(e,t){}})}();