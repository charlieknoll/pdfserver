!function(a){var f,b=this||eval("this"),c=b.document;b.navigator,b.JSON;f=function(p,e){function r(e,t){var s=this;s.element=e,s.headers=[];for(var a=e.getElementsByClassName(t.groupHeaderClass),o=0;o<a.length;o++)s.element===a[o].parentElement&&s.headers.push(a[o].cloneNode(!0));s.firstPage=null}function i(e,t){var s=this;if(s.element=e,s.options=t.options,p.utils.wrapInner(e,"div","class",p.wrapperClass),s.innerContent=s.element.childNodes[0],0<t.pages.length){var a,o,r=s.element.childNodes[0];for(o=0;o<t.headers.length;++o)a=t.headers[o].cloneNode(!0),r.insertBefore(a,null);for(s.firstFooter=null,o=0;o<t.footers.length;o++)0===o?(s.firstFooter=t.footers[o].cloneNode(!0),r.insertBefore(s.firstFooter,null)):r.insertBefore(t.footers[o].cloneNode(!0),null)}else 0<t.footers.length&&(s.firstFooter=t.footers[0]);s.insertSpacer(),s.availableHeight=0,s.innerHeight=t.pageInnerHeight,s.nodesAdded=0}function o(e,t,s){var a=this;a.options=new Options(s),a.target=e;var o=a.options.fontDelay;if(a.options.showLoading&&o<500&&(o=500),t.className.includes(a.options.pageClass)||(t.classList.add(a.options.pageClass),console.log("WARNING: The page container class'"+a.options.pageClass+"' was not found on source, responsive elements may not display correctly.")),a.options.showLoading){var r=c.createElement("div");r.innerHTML='<div class="'+a.options.pageClass+" "+a.options.paperType()+'"><div class="rjs-loading"><div></div><div>Generating report...</div></div></div>',r.style.marginBottom="1000px",e.parentElement.insertBefore(r,e)}for(var n=null,i=a.options.prefix+"ps-",l=0;l<t.classList.length;l++)t.classList[l].substring(0,i.length)==i&&(n=t.classList[l]);a.options.setPaperType(n);var p=a.options.hiddenCss(),d=c.head||c.getElementsByTagName("head")[0],g=c.createElement("style");g.type="text/css",g.styleSheet?g.styleSheet.cssText=p:g.appendChild(c.createTextNode(p)),d.appendChild(g),t.classList.remove(n),t.classList.add(a.options.paperType()),a.blankPageCt=0,b.setTimeout(function(){a.init(e,t),a.generate(!0),a.options.showLoading&&(e.style.display="",r.parentElement.removeChild(r),b.scrollBy(0,-b.pageYOffset)),b[a.options.chromePdfOptionsPropertyName]=a.options.chromeOptions(),b[a.options.renderCompletePropertyName]=!0},o)}NodeList.prototype.last||(NodeList.prototype.last=function(){return this[this.length-1]}),Node.prototype.deleteChildren=function(){for(;this.firstChild;)this.removeChild(this.firstChild)},(p=p||{}).version="##VERSION##",p.wrapperClass="rjs-parent",p.hidden={},p.hiddenBreakPoints=[["a6"],["a5","a6-ls"],["a4","a5-ls"],["letter","legal"],["letter-ls","tabloid","ledger-ls"],["a3","a4-ls"],["legal-ls"],["a2","a3-ls"],["ledger","tabloid-ls"],["a1","a2-ls"],["a0","a1-ls"],["a0-ls"]],Options=function(e){var t=this,s={showLoading:!(t.prefix="rjs-"),showToolbar:!0,hideSource:!0,base64EncodeImages:!1,format:null,orientation:null,marginLeft:.7,marginTop:.7,marginRight:.7,marginBottom:.7,imageDPI:96,embedFonts:!0,pageClass:t.prefix+"page",pageHeaderClass:t.prefix+"page-header",hidePageHeadersClass:t.prefix+"hide-page-headers",pageFooterClass:t.prefix+"page-footer",hidePageFootersClass:t.prefix+"hide-page-footers",alignBottomClass:t.prefix+"page-footer",groupClass:t.prefix+"group",groupHeaderClass:t.prefix+"group-header",keepTogetherClass:t.prefix+"keep-together",forcePageBreakClass:t.prefix+"force-page-break",hideOnFirstPageClass:t.prefix+"hide-on-first-page",pageCountClass:t.prefix+"page-count",pageNumberClass:t.prefix+"page-number",idPageNumberClass:t.prefix+"id-page-number",minimumGroupChildren:1,pdfRenderingUrl:"render.reportsjs.com",renderAuthKey:"",fontDelay:100,parseableNodeNames:["P","BLOCKQUOTE"],keepTogetherNodeNames:["TR","THEAD","TFOOT","CANVAS"],groupNodeNames:["TABLE","DL","DETAILS","OL","UL"],groupHeaderNodeNames:["DT","THEAD","COLGROUP","SUMMARY"],chromePdfOptionsPropertyName:"RESPONSIVE_PAPER_CHROME_PDF_OPTIONS",renderCompletePropertyName:"RESPONSIVE_PAPER_FINISHED"};e&&(e.format&&(e.format=e.format.toLowerCase()),e.landscape&&(e.orientation="landscape"),!1===e.landscape&&(e.orientation="portrait")),p.utils.extend(t,s),p.utils.extend(t,e)},Options.prototype.setPaperType=function(e){var t=this,s=t.prefix+"ps-";null===e&&(e=s+"letter"),e.endsWith("-ls")&&!t.orientation&&(t.orientation="landscape"),t.orientation||(t.orientation="portrait"),e.endsWith("-ls")&&(e=e.substring(0,e.length-3)),e.length>s.length&&!t.format&&e.startsWith(s)&&(t.format=e.split(s)[1])},Options.prototype.paperType=function(){var e=this,t=e.prefix+"ps-"+e.format;return"landscape"==e.orientation&&(t+="-ls"),t},Options.prototype.hiddenCss=function(){var t=this,s="",a=t.format,o=!1;"landscape"==t.orientation&&(a+="-ls");for(var e=0;e<p.hiddenBreakPoints.length;e++)o||p.hiddenBreakPoints[e].forEach(function(e){e===a&&(o=!0)}),o&&p.hiddenBreakPoints[e].forEach(function(e){s+="."+t.prefix+"hidden-"+e+" {display: none} "});return s},Options.prototype.chromeOptions=function(){var e=this,t={};return t.format=e.format.substring(0,1).toUpperCase()+e.format.substring(1),t.margin={},t.margin.top=0,t.margin.left=0,t.margin.right=0,t.margin.bottom=0,t.marginTop=0,t.marginLeft=0,t.marginRight=0,t.marginBottom=0,t.landscape="landscape"===e.orientation,t},p.utils={extend:function(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var s in arguments[t])arguments[t].hasOwnProperty(s)&&(e[s]=arguments[t][s]);return e},wrapInner:function(e,t,s,a){"string"==typeof t&&(t=c.createElement(t));for(e.appendChild(t).setAttribute(s,a);e.firstChild!==t;)t.appendChild(e.firstChild)},outerHeight:function(e,t){var s=e.offsetHeight;if(!t)return s;var a=b.getComputedStyle(e);return s+=parseInt(a.marginTop)+parseInt(a.marginBottom)},height:function(e){var t=b.getComputedStyle(e,null);return parseInt(t.height)-Math.round(parseFloat(t.paddingTop))-Math.round(parseFloat(t.paddingBottom))},clean:function(e,t){for(var s=0;s<e.childNodes.length;s++){var a=e.childNodes[s];8===a.nodeType&&t||3===a.nodeType&&!/\S/.test(a.nodeValue)?(e.removeChild(a),s--):1===a.nodeType&&this.clean(a,t)}},nodesToArray:function(e){return Array.prototype.slice.call(e,0)},isDescendant:function(e,t){for(var s=t.parentNode;null!=s;){if(s==e)return!0;s=s.parentNode}return!1},poll:function(t,s,a,e,o){var r=Number(new Date)+(e||2e3);o=o||100,function e(){t()?s():Number(new Date)<r?setTimeout(e,o):a(new Error("timed out for "+t+": "+arguments))}()}},r.prototype.isFirstPage=function(e){return!this.firstPage||this.firstPage.element===e.element},i.prototype.hasParentOfClass=function(e,t){return!!e.parentElement.classList.contains(t)||this.element!=e&&this.hasParentOfClass(e.parentElement,t)},i.prototype.insertSpacer=function(){var e=this.element.childNodes[0],t=c.createElement("div");t.style.height="0px",t.innerHTML="<span style='visibility:hidden;'></span>",t.classList.add("rjs-spacer"),e.insertBefore(t,this.firstFooter),this.firstFooter=t},i.prototype.setAvailableHeight=function(){var e=this.element.childNodes[0];this.availableHeight=this.innerHeight-p.utils.outerHeight(e,!0)},i.prototype.checkAvailableHeight=function(){return this.setAvailableHeight(),0<this.availableHeight},i.prototype.showElements=function(e,t,s){for(var a=e.childNodes.length-1;-1<a;a--){var o=e.childNodes[a];o.classList&&o.classList.contains(t)&&(o.style.display="initial"),o.classList&&!o.classList.contains(s)&&this.showElements(o,t,s)}},i.prototype.deleteElementsByClassName=function(e){p.utils.nodesToArray(this.element.getElementsByClassName(e)).forEach(function(e){e.parentNode.removeChild(e)})},i.prototype.insertElement=function(e,t,s,a){var o=this,r=e.insertBefore(t,s);return r.classList&&r.classList.contains(o.options.hidePageHeadersClass)&&o.deleteElementsByClassName(o.options.pageHeaderClass),r.classList&&r.classList.contains(o.options.hidePageFootersClass)&&o.deleteElementsByClassName(o.options.pageFooterClass),a||o.showElements(r,o.options.hideOnFirstPageClass,o.options.groupClass),o.setAvailableHeight(),o.nodesAdded++,r},i.prototype.removeElement=function(e){e.parentNode.removeChild(e),this.setAvailableHeight()},o.prototype.init=function(e,t){var s=this;s.target=e;var a=p.utils.nodesToArray(t.getElementsByTagName("CANVAS"));s.canvasObjs=[];var o=0;a.forEach(function(e){var t={};""===e.id&&(e.id="id-rjs-"+o++),t.id=e.id,t.el=e.cloneNode(!0),t.el.getContext("2d").drawImage(e,0,0),s.canvasObjs.push(t)});var r=t.cloneNode(!0);p.utils.nodesToArray(r.getElementsByClassName(s.options.forcePageBreakClass)).forEach(function(e){for(;r!=e.parentNode;)e.parentNode.containsPageBreak=!0,e=e.parentNode}),r.style.display="",s.initId=r.id;var n=s.target.insertBefore(r,t);s.options.hideSource&&t.parentElement.removeChild(t),s.removeAttributes(n,"contenteditable"),s.options.groupNodeNames.map(function(e){return s.addClassToElements(n,e,s.options.groupClass)}),s.options.groupHeaderNodeNames.map(function(e){return s.addClassToElements(n,e,s.options.groupHeaderClass)}),s.headers=r.getElementsByClassName(s.options.pageHeaderClass),s.footers=r.getElementsByClassName(s.options.pageFooterClass),s.setPageInnerHeight(r),s.pages=[],s.lastPage=new i(r,s),s.pages=[s.lastPage],s.groups=[]},o.prototype.removeAttributes=function(e,t){Array.prototype.slice.call(e.querySelectorAll("["+t+"]"),0).map(function(e){e.removeAttribute(t)})},o.prototype.addDefaultClass=function(e,t){e.classList.add(t)},o.prototype.addClassToElements=function(e,t,s){var a=this;Array.prototype.slice.call(e.getElementsByTagName(t),0).map(function(e){a.addDefaultClass(e,s)})},o.prototype.updateCanvasEls=function(){var s=this;s.canvasObjs.forEach(function(e){var t=s.target.querySelector("#"+e.id);t&&t.getContext("2d").drawImage(e.el,0,0)})},o.prototype.generate=function(e){if(e&&(p.startTime=(new Date).getTime()),self=this,self.splitPages(),self.updateCanvasEls(),self.setPageProperties(),self.alignBottomElements(),e){var t=(new Date).getTime();console.log("Formatting finished in "+(t-p.startTime)/1e3+" seconds")}},o.prototype.alignBottomElements=function(){for(var e=0;e<this.pages.length;e++){var t=this.pages[e];t.setAvailableHeight();var s=t.element.getElementsByClassName("rjs-spacer");if(0<t.availableHeight&&0<s.length)s[0].style.height=t.availableHeight+"px"}},o.prototype.upsertGroup=function(e,t){for(var s=this,a=null,o=0;o<s.groups.length;o++)if(s.groups[o].element===e){(a=s.groups[o]).firstPage||(a.firstPage=t);break}return a||((a=new r(e,s.options)).firstPage=t,s.groups.push(a)),a},o.prototype.setPageProperties=function(){var e=this,t=p.utils.nodesToArray(e.target.getElementsByClassName(e.options.idPageNumberClass)).map(function(e){return{el:e,id:e.getAttribute("data-id")}});t=t.filter(function(e){var t=c.getElementById(e.id);if(t)return e.target=t,e});for(var s=1;s<=e.pages.length;s++){for(var a=e.pages[s-1],o=a.element.getElementsByClassName(e.options.pageNumberClass),r=0;r<o.length;r++)o[r].innerHTML=s;for(o=a.element.getElementsByClassName(e.options.pageCountClass),r=0;r<o.length;r++)o[r].innerHTML=e.pages.length;t=t.filter(function(e){if(!p.utils.isDescendant(a.element,e.target))return e;e.el.innerHTML=s}),a.element.id=e.initId+"Page"+s,a.element.style.display=""}},o.prototype.insertPage=function(){var e,t,s=this,a=new i(s.lastPage.element.cloneNode(!1),s);if(s.pages.splice(s.pages.length-1,0,a),s.lastPage.element.parentNode.insertBefore(a.element,s.lastPage.element),2<s.pages.length)for(e=a.element.getElementsByClassName(s.options.hideOnFirstPageClass),t=0;t<e.length;t++)e[t].classList.remove(s.options.hideOnFirstPageClass);if(2==s.pages.length)for(e=s.lastPage.element.getElementsByClassName(s.options.hideOnFirstPageClass),t=0;t<e.length;t++)(s.lastPage.hasParentOfClass(e[t],s.options.pageHeaderClass)||s.isPageHeader(e[t]))&&e[t].classList.remove(s.options.hideOnFirstPageClass);return a.setAvailableHeight(),a},o.prototype.isKeepTogetherNode=function(e){return-1<this.options.keepTogetherNodeNames.indexOf(e.nodeName)||!!e.classList&&(e.classList.contains(this.options.keepTogetherClass)||e.classList.contains(this.options.groupHeaderClass))},o.prototype.isParseableNode=function(e){return 3===e.nodeType||-1<this.options.parseableNodeNames.indexOf(e.nodeName)},o.prototype.isPageBand=function(e){if(!e.classList)return!1;return e.classList.contains(this.options.pageHeaderClass)||e.classList.contains(this.options.pageFooterClass)},o.prototype.isGroupBand=function(e){if(!e.classList)return!1;return e.classList.contains(this.options.groupClass)},o.prototype.isGroupHeader=function(e){if(!e.classList)return!1;return e.classList.contains(this.options.groupHeaderClass)},o.prototype.isForcePageBreak=function(e){if(!e.classList)return!1;return e.classList.contains(this.options.forcePageBreakClass)},o.prototype.isPageHeader=function(e){if(!e.classList)return!1;return e.classList.contains(this.options.pageHeaderClass)},o.prototype.convertImageTobase64=function(s){if("IMG"===s.nodeName){var a=c.createElement("CANVAS"),o=a.getContext("2d"),r=new Image;r.crossOrigin="Anonymous",r.onload=function(e){a.height=r.height,a.width=r.width,o.drawImage(r,0,0);var t=a.toDataURL("image/png",1);$(s).attr("src",t),a=null},r.src=s.src}},o.prototype.splitArray=function(e,t,s,a,o){var r=s.offsetHeight,n=t.availableHeight,i=e.splice(0,e.length-a);if(s.lastChild.data=i.join(" "),r!=s.offsetHeight&&t.setAvailableHeight(),0<=t.availableHeight&&0===e.length)return e;if(o<=1&&0<=t.availableHeight&&n<0)return e;var l=0;return l=0<t.availableHeight?a-Math.round(o/2):a+Math.round(o/2),this.splitArray(i.concat(e),t,s,l,Math.abs(l-a))},o.prototype.moveTextBetweenNodesFast=function(e,t,s){if(s.availableHeight<1)return!1;var a=t.textContent.trim().replace(/[\n\r]+/g,"").replace(/\s{2,10}/g," ").split(" "),o=Math.round(a.length/2);return 0!==e.childNodes.length&&3===e.lastChild.nodeType||(e.innerHTML=e.innerHTML+" "),sourceArray=this.splitArray(a,s,e,o,o),0===sourceArray.length&&s.checkAvailableHeight()?(t.parentElement.removeChild(t),!1):(t.data=sourceArray.join(" "),!0)},o.prototype.moveTextBetweenNodes=function(e,t,s){var a=t.textContent.trim().replace(/[\n\r]+/g,"").replace(/\s{2,10}/g," ").split(" ");a.reverse();var o=e.offsetHeight,r="";for(0!==e.childNodes.length&&3===e.lastChild.nodeType||(e.innerHTML=e.innerHTML+" ");0<a.length&&(o===e.offsetHeight||s.checkAvailableHeight());)o=e.offsetHeight,r=a.pop(),e.lastChild.data=e.lastChild.data+" "+r;return 0===a.length&&s.checkAvailableHeight()?(t.parentElement.removeChild(t),!1):(a.push(r),a.reverse(),t.data=a.join(" "),e.lastChild.data=e.lastChild.data.substring(0,e.lastChild.data.length-r.length-1),!0)},o.prototype.moveParseableChildNodes=function(e,t,s){var a=s.childNodes;if(0===a.length)return!1;for(var o=0;o<a.length;o++){var r=a[o];if(3===r.nodeType){if(this.moveTextBetweenNodesFast(t,r,e))return!0}else{if(t.insertBefore(r.cloneNode(!1),null),!e.checkAvailableHeight())return t.removeChild(t.lastChild),!0;if(this.moveParseableChildNodes(e,t.lastChild,r))return!0;s.removeChild(r)}--o}return!1},o.prototype.shouldPageBreak=function(e){return!!this.isForcePageBreak(e)&&(this.pageBreakElement!==e&&(this.pageBreakElement=e,!0))},o.prototype.resetGroupBandSource=function(e,t,s,a){var o=p.utils.height(t),r=t.getElementsByClassName(this.options.groupHeaderClass);for(j=0;j<r.length;j++)r[j].parentNode===t&&(o-=p.utils.outerHeight(r[j],!0));if(0===o){for(var n=s.getElementsByClassName(this.options.groupHeaderClass);0<n.length;)n[0].remove();e.removeElement(t),a.firstPage=null}for(var i=s.childNodes[0],l=0;l<a.headers.length;l++)e.insertElement(s,a.headers[l].cloneNode(!0),i,a.isFirstPage(e))},o.prototype.insertGroupBand=function(e,t,s,a){var o=this.upsertGroup(s,e),r=e.insertElement(t,s.cloneNode(!1),a,o.isFirstPage(e));return!!this.moveChildElements(s,e,r,null,o)&&(this.resetGroupBandSource(e,r,s,o),!0)},o.prototype.moveChildElements=function(e,t,s,a,o){var r,n=this,i=e.childNodes;if(0===i.length&&0<t.availableHeight)return!1;var l=!o||o.firstPage===t;t.insertingElementHTML=e.cloneNode(!1).outerHTML;for(var p=0;p<i.length;p++){var d=i[p];if((!d.style||"hidden"!==d.style.visibility)&&!n.isPageBand(d)){if(!0===n.shouldPageBreak(d))return d.classList.remove(n.options.forcePageBreakClass),t.pageBreak=!0;var g=n.isKeepTogetherNode(d);if(n.isGroupBand(d)&&!g){if(n.insertGroupBand(t,s,d,a))return!0}else{var h=n.isParseableNode(d),c=t.availableHeight>(d.offsetHeight||0)&&!d.containsPageBreak,f=d.cloneNode(c||g),u=0,m=!1;if(!c&&0<d.childNodes.length&&!h&&!g)for(var v=d.offsetHeight;0<d.childNodes.length&&u<t.availableHeight&&!n.isForcePageBreak(d.childNodes[0]);)f.insertBefore(d.removeChild(d.childNodes[0]),null),(u=v-d.offsetHeight)>t.availableHeight&&(d.insertBefore(f.removeChild(f.lastChild),d.childNodes[0]),m=!0);if(r=t.insertElement(s,f,a,l),f.classList&&f.classList.contains("rjs-contain")&&t.availableHeight<0&&(f.style.maxHeight=t.availableHeight+(d.offsetHeight?d.offsetHeight:d.scrollHeight)-1+"px",t.setAvailableHeight()),t.availableHeight<0||m){if(g||!h&&0===d.childNodes.length)return t.removeElement(r),t.setAvailableHeight(),!0;if(0<r.childNodes.length)if(0===u)r.deleteChildren(),t.setAvailableHeight();else for(;!t.checkAvailableHeight();)d.insertBefore(r.removeChild(r.lastChild),d.childNodes[0]);return h?n.moveParseableChildNodes(t,r,d):n.moveChildElements(d,t,r,null,o),!0}if(0<d.childNodes.length&&n.isForcePageBreak(d.childNodes[0]))return t.pageBreak=!0,d.childNodes[0].classList.remove(n.options.forcePageBreakClass),!0}d.parentNode.removeChild(d),n.options.convertImageTobase64&&n.convertImageTobase64(r),--p}}return!1},o.prototype.setPageInnerHeight=function(e){this.pageInnerHeight=p.utils.height(e)},o.prototype.splitPages=function(){var e=this;e.lastPage.setAvailableHeight();var t=e.lastPage.availableHeight,s=e.insertPage();if(e.moveChildElements(e.lastPage.innerContent,s,s.innerContent,s.firstFooter)){if(s.pageBreak&&e.splitPages(),e.lastPage.setAvailableHeight(),t===e.lastPage.availableHeight){if(0!==e.blankPageCt){console.log("Infinite loop avoided, check report design for 'keep-together' or 'group-header' nodes that are too large to fit on one page");var a=c.createElement("div");return a.innerHTML="<div style='color:red'><p>ERROR: <br/>Layout engine could not add content to the page container. Possible solutions:</p><ul><li>Increase page height by removing landscape or selecting a larger paper format.</li><li>Shrink items so they can fit on a page, e.g. use max-height on images or canvas elements</li><li>Check report design for 'keep-together' or 'group-header' nodes that are too large to fit on one page</li><li>Add rp-contain class to element that is not able to fit on one page</li></ul><p>Element html:</p><xmp>"+e.pages[e.pages.length-2].insertingElementHTML+"</xmp></div>",void e.pages[0].element.insertBefore(a,e.pages[0].element.firstChild)}e.blankPageCt++,console.log("Could not add any content to page, try removing force-page-break from first group or shrinking items so they can fit on a page")}e.splitPages()}else e.lastPage.element.remove(),e.lastPage=s,e.pages.pop(e.pages.length-1),1===e.blankPageCt&&(e.lastPage.element.remove(),e.pages.pop(e.pages.length-1),e.lastPage=e.pages[e.pages.length-1])},p.createTarget=function(e,t){var s=c.createElement("div");return s.innerHTML="<div id='previewPane' class='rjs-target'><span style='visibility:hidden;'>\x3c!--first element --\x3e</span></div>",e.insertBefore(s,t),s.childNodes[0]},p.preview=function(e,t){if(e||(e=[c.querySelector(".rjs-page")]),!e){e=[b.document.body];var s=c.createElement("div");Array.prototype.slice.call(b.document.body.childNodes,0).map(function(e){s.appendChild(e)}),s.classList.add("rjs-page"),b.document.body.insertBefore(s,null),e[0]=b.document.body.firstChild}target=e[0].parentNode;for(var a=0;a<e.length;a++){p.utils.clean(e[a],!0);new o(target,e[a],t)}target.style.overflow="",target.style.maxHeight=""},p.renderAsPDF=function(e,t,s){},p.refresh=function(e,t){},p.renderAsExcel=function(e,t){}},"function"==typeof define&&define.amd?define(["exports","require"],f):"object"==typeof exports&&"object"==typeof module?f(module.exports||exports):f(b.rjs={})}();